<%- include ('partials/header'); -%>

  <link rel="stylesheet" type="text/css" href="/css/admin_dashboard.css">
  </head>

  <body>

    <%- include ('partials/nav_bar_modal'); -%>

      <!--Header section-->
      <!--Use .container-fluid for a full width container, spanning the entire width of the viewport.-->
      <!--make padding in x-axis = 0px-->
      <section class="container general-container">
        <div class="container-fluid">
          <div class="row justify-content-center">
            <div class="card-deck">
              <div class="card text-center total-visits">
                <div class="icon-space"><i class="fas fa-chart-line fa-2x"></i></div>
                <div class="card-body">
                  <h3 class="card-title">
                    <%=noOfVisits%>
                  </h3>
                  <h5 class="card-text text-center">Total Visit(s)</>
                </div>
              </div>
              <div class="card text-center unique-visitor">
                <div class="icon-space"><i class="fas fa-users fa-2x"></i></div>
                <div class="card-body">
                  <h3 class="card-title">
                    <%=noOfVisitors%>
                  </h3>
                  <h5 class="card-text text-center">Unique Visitor(s)</>
                </div>
              </div>
            </div>
          </div>

          <br>

          <div class="content">
            <div class="row">
              <div class="col-md-12">
                <div class="card table-card">
                  <div class="card-header">
                    <h4 class="card-title">List of TechTa Users</h4>
                  </div>
                  <div class="card-body">
                    <div class="table-responsive">
                      <table class="table tablesorter " id="">
                        <thead class=" text-primary text-center">
                          <tr>
                            <th>
                              Username
                            </th>
                            <th>
                              Phone Number
                            </th>
                            <th>
                              Email
                            </th>
                            <th>
                              Last Login Time
                            </th>
                            <th>
                              Number of Visits
                            </th>
                            <th>
                              Admin Status
                            </th>
                          </tr>
                        </thead>
                        <tbody class="text-center">
                          <% allUsers.forEach((user)=> { %>
                            <tr>
                              <td>
                                <%=user.username%>
                              </td>
                              <td>
                                <%=user.phoneNum%>
                              </td>
                              <td>
                                <%=user.email%>
                              </td>
                              <td>
                                <%=user.lastLogin%>
                              </td>
                              <td>
                                <%=user.visitsNo%>
                              </td>
                              <td>

                                <% if (!(currentUser._id.equals(user._id))){ if (user.isAdmin) { %>
                                  <form action="/users/<%= user._id %>?_method=PUT" method="POST">
                                    <input type="submit" class="btn btn-outline-primary"
                                      value="Dismiss as Admin"></input>
                                  </form>
                                  <% } else{ %>
                                    <form action="/users/<%= user._id %>?_method=PUT" method="POST">
                                      <input type="submit" class="btn btn-outline-primary" value="Make Admin"></input>
                                    </form>
                                    <% }}%>
                              </td>
                            </tr>
                            <% });%>
                        </tbody>
                      </table>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

        </div>
      </section>

      <!-- Optional JavaScript -->
      <!-- jQuery first, then Popper.js, then Bootstrap JS -->
      <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"
        integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
        crossorigin="anonymous"></script>
      <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"
        integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
        crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/owl.carousel.min.js"></script>
      <script src="/js/main.js"></script>

  </body>

  </html>